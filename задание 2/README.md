# Задание 2
 Время на тестирование этой задачи не хватило (создать тестовую базу)
  ```sql
SELECT SUM(tablResult.Стоимость)
FROM (
         /*
                   Основная выборка из 3 join запросов –
                   Остатки, Цена в валюте и Курс.
                   (t1.КодТовара в выборке для возможной отладки, не обязателен)
          */
         SELECT t2.Остаток * (t3.Цена * t4.Курс) AS Стоимость,
                t1.КодТовара
         FROM Товар AS t1
                  LEFT JOIN(

             --  Join 1: Извлекаем остатки по всем товарам
             SELECT Остаток,
                    КодТовара
             FROM Остатки
             WHERE КодТовара = t1.КодТовара
               -- '2016-01-10' кастомное значение
               AND ДатаС > '2016-01-10'
               AND ДатаПо < '2016-01-10'
               -- Удаляем товары не в наличии
             HAVING Остаток > 0
         ) AS t2 ON t2.КодТовара = t1.КодТовара
                  LEFT JOIN(
             -- Join 2: Находим актуальную цену для всех товаров
             SELECT t3.Цена,
                    t3.КодТовара
             FROM (
                      SELECT Цена,
                             КодТовара
                      FROM Цены
                      WHERE Дата < '2016-01-10'
                      ORDER BY Дата DESC
                      -- сначала сортировка по дате потом группировка, чтобы получить уникальные значения

                  ) AS t3
             GROUP BY t3.КодТовара
         ) AS t3 ON t3.КодТовара = t1.КодТовара
                  LEFT JOIN(
             -- Join 3: Находим актуальный курс для всех валют
             SELECT DISTINCT Курс,
                             КодВалюты
             FROM Курсы
             WHERE Дата = '2016-01-10'
         ) AS t4 ON t4.КодВалюты = t1.КодВалюты
     ) AS tablResult
 ```